<div class="main-content page-m">
    <div class="section-content section-content-p30">
        <div class="container-fluid">
            <h1>Mantenimiento datos Ofertas</h1>
            <br>
            <br>
            <form [formGroup]="altaOfertaFormGroup" (ngSubmit)="onSubmit()">
                <!-- Ofertas Form Group-->
                <div formGroupName="newOferta" class="form-area">
                    <h3>Ofertas</h3>
                    <div class="row">
                        <div class="col-md-3"><label>Descripcion</label></div>
                        <div class="col-md-9">
                            <div class="input space">
                                <textarea formControlName="description"></textarea>
                            </div>
                            <!--<div *ngIf="description.invalid && (description.dirty || description.touched)" class="alert alert-danger">
                                <div *ngIf="description.errors.required">
                                    Descripcion requerida
                                </div>
                                <div *ngIf="description.errors.minlength">
                                    Descripcion muy corta
                                </div>
                                </div>-->
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-3"><label>Tiempo de Oferta</label></div>
                        <div class="col-md-9">
                            <div class="input space">
                                <input formControlName="deadline" type="date"> 
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-3"><label>Añadir puntos</label></div>
                        <div class="col-md-9">
                            <div class="input space">
                                <input formControlName="addPoints" type="text">
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-3"><label>Coste de puntos</label></div>
                        <div class="col-md-9">
                            <div class="input space">
                                <input formControlName="subPoints" type="text">
                            </div>
                        </div>
                    </div>
                </div>                
                <!--submit button-->
                <div class="text-center">
                    <button type="submit" class="btn btn-info" data-toggle="modal" data-target="#registroConfirmacion">Registrar Oferta</button>
                </div>
            </form>
            <!--Tabla de ofertas-->
            <br>
            <br>
            <div class = "table-responsive-md">
                <table class="table table-striped table-hover table-light">
                    <thead>
                        <tr>
                            <th scope="col">Nº de oferta</th>
                            <th scope="col">Descripcion</th>
                            <th scope="col">Tiempo de Oferta</th>
                            <th scope="col">Puntos adicionales</th>
                            <th scope="col">Costo de puntos</th>
                            <th scope="col">Ver Oferta</th>
                            <th scope="col">Eliminar Oferta</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let tempOffer of offers">
                            <td>{{tempOffer.id}}</td>
                            <td>{{tempOffer.description}}</td>
                            <td>{{tempOffer.deadline}}</td>
                            <td>{{tempOffer.addPoints}}</td>
                            <td>{{tempOffer.subPoints}}</td>
                            <td><app-cart-status></app-cart-status></td>

                            <td><button type="submit" class="btn btn-info">Ver Oferta</button></td>
                            <td><button type="submit" class="btn btn-success">Aplicar Oferta</button></td>
                            <td><button (click) = "deleteOffers()" routerLink="/alta-oferta" class="btn btn-danger">Eliminar Oferta</button></td>

                            <td>
                            <button (click) = "deleteOffers(tempOffer.id)"  class="btn btn-danger" data-toggle="modal" data-target="#deleteConfirmacion" >
                                Eliminar Oferta
                            </button>
                            </td>

                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
<!-- Mensaje de confirmación registrar oferta-->
<div class="modal fade"
    id="registroConfirmacion" 
    tabindex="-1" 
    role="dialog" 
    aria-labelledby="registroConfirmacion" 
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title text-dark" id="registroConfirmacionTitle">Confirmacion registrar oferta</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div *ngIf="mensaje">
                    Se ha registrado correctamente la oferta.
                </div >
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>
<!--Mensaje de confirmacion eliminar oferta-->
<div class="modal fade"
    id="deleteConfirmacion" 
    tabindex="-1" 
    role="dialog" 
    aria-labelledby="deleteConfirmacion" 
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title text-dark" id="deleteConfirmacionTitle">Confirmacion elimar oferta</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                Se ha eliminado correctamente la oferta.
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>

